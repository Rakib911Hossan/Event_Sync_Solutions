<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.Button?>
<?import javafx.scene.control.CheckBox?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ScrollPane?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>

<AnchorPane prefHeight="750.0" prefWidth="1080.0" style="-fx-background-color: #2b2d42;" stylesheets="@style.css" xmlns="http://javafx.com/javafx/22" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.Corporate.Event_Sync.controller.SendOfferTokenController">
    <children>
        <!-- Header -->
        <Label layoutX="350.0" layoutY="20.0" style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #FF9800;" text="Send Promotional Offer Tokens" />

        <!-- Main Container -->
        <ScrollPane layoutX="50.0" layoutY="80.0" prefHeight="640.0" prefWidth="980.0" fitToWidth="true" style="-fx-background: transparent; -fx-background-color: transparent;">
            <VBox spacing="15.0" style="-fx-background-color: #4a4e69; -fx-background-radius: 15; -fx-padding: 30px;">

                <!-- Token Type Selection -->
                <VBox spacing="10.0">
                    <Label style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #ffffff;" text="Select Offer Type:" />
                    <ComboBox fx:id="offerTypeComboBox" prefWidth="350.0" promptText="Choose offer type" style="-fx-font-size: 14px;" />
                </VBox>

                <!-- Custom Offer Details -->
                <VBox fx:id="customOfferBox" managed="false" spacing="10.0" visible="false">
                    <Label style="-fx-font-size: 14px; -fx-text-fill: #ffffff;" text="Offer Title:" />
                    <TextField fx:id="offerTitleField" prefWidth="350.0" promptText="e.g., Flash Sale - 30% OFF" />

                    <Label style="-fx-font-size: 14px; -fx-text-fill: #ffffff;" text="Discount Percentage:" />
                    <TextField fx:id="discountField" prefWidth="350.0" promptText="e.g., 25" />

                    <Label style="-fx-font-size: 14px; -fx-text-fill: #ffffff;" text="Offer Description:" />
                    <TextArea fx:id="offerDescriptionArea" prefHeight="80.0" prefWidth="350.0" promptText="Enter offer details..." wrapText="true" />
                </VBox>

                <!-- User Selection -->
                <VBox spacing="10.0">
                    <HBox alignment="CENTER_LEFT" spacing="15.0">
                        <Label style="-fx-font-size: 16px; -fx-font-weight: bold; -fx-text-fill: #ffffff;" text="Select Recipients:" />
                        <CheckBox fx:id="selectAllCheckBox" onAction="#handleSelectAll" style="-fx-text-fill: #ffffff;" text="Select All" />
                        <Button onAction="#handleRefreshUsers" style="-fx-background-color: #2196F3; -fx-text-fill: white; -fx-padding: 5px 15px;" text="ðŸ”„ Refresh" />
                    </HBox>

                    <!-- Filter Section -->
                    <VBox spacing="8.0" style="-fx-background-color: #3a3e59; -fx-padding: 15px; -fx-background-radius: 8;">
                        <Label style="-fx-font-size: 14px; -fx-font-weight: bold; -fx-text-fill: #FFD700;" text="ðŸ” Filters:" />

                        <HBox spacing="15.0" alignment="CENTER_LEFT">
                            <CheckBox fx:id="studentFilterCheckBox" style="-fx-text-fill: #ffffff;" text="Students Only" />
                            <Label style="-fx-text-fill: #ffffff;" text="Category:" />
                            <ComboBox fx:id="userCategoryComboBox" prefWidth="150.0" promptText="All Categories" style="-fx-font-size: 13px;" />
                            <Button onAction="#handleClearFilters" style="-fx-background-color: #607D8B; -fx-text-fill: white; -fx-padding: 5px 15px;" text="âœ– Clear Filters" />
                        </HBox>
                    </VBox>

                    <!-- Search Box -->
                    <TextField fx:id="searchField" onKeyReleased="#handleSearch" prefWidth="350.0" promptText="ðŸ” Search users by name or email..." />

                    <!-- Filtered Count -->
                    <Label fx:id="filteredCountLabel" style="-fx-font-size: 13px; -fx-text-fill: #A0C4FF;" text="Showing: 0 / 0 users" />

                    <!-- User List ScrollPane with better visibility -->
                    <ScrollPane fitToWidth="true" prefHeight="250.0" style="-fx-background: #2C3E50; -fx-background-color: #2C3E50; -fx-border-color: #4CAF50; -fx-border-width: 2px; -fx-border-radius: 5;">
                        <VBox fx:id="userListContainer" spacing="8.0" style="-fx-padding: 15px; -fx-background-color: #2C3E50;" />
                    </ScrollPane>

                    <!-- Selected Count -->
                    <Label fx:id="selectedCountLabel" style="-fx-font-size: 14px; -fx-font-weight: bold; -fx-text-fill: #FFD700;" text="Selected: 0 users" />
                </VBox>

                <!-- Action Buttons -->
                <HBox alignment="CENTER" spacing="20.0" style="-fx-padding: 10px 0 0 0;">
                    <Button fx:id="sendButton" onAction="#handleSendOffers" prefHeight="40.0" prefWidth="150.0" style="-fx-background-color: #4CAF50; -fx-text-fill: white; -fx-font-size: 16px; -fx-font-weight: bold; -fx-cursor: hand;" text="ðŸ“§ Send Offers" />
                    <Button onAction="#handlePreview" prefHeight="40.0" prefWidth="150.0" style="-fx-background-color: #FF9800; -fx-text-fill: white; -fx-font-size: 16px; -fx-font-weight: bold; -fx-cursor: hand;" text="ðŸ‘ Preview" />
                    <Button onAction="#handleCancel" prefHeight="40.0" prefWidth="150.0" style="-fx-background-color: #E74C3C; -fx-text-fill: white; -fx-font-size: 16px; -fx-font-weight: bold; -fx-cursor: hand;" text="âŒ Cancel" />
                </HBox>

                <!-- Status Message -->
                <Label fx:id="statusLabel" style="-fx-font-size: 14px; -fx-text-fill: #3ac5ac; -fx-wrap-text: true;" wrapText="true" />

            </VBox>
        </ScrollPane>

        <!-- Back Button -->
        <Button layoutX="30.0" layoutY="20.0" onAction="#handleBack" style="-fx-background-color: transparent; -fx-text-fill: #3ac5ac; -fx-border-color: #3ac5ac; -fx-border-width: 2px; -fx-padding: 8px 20px; -fx-cursor: hand;" text="â† Back to Home" />
    </children>
</AnchorPane>